        # =============================
        # WS ì˜ìƒ + ìƒíƒœ ZMQ ì „ì†¡
        # =============================
        if ws_sock is not None:
            try:
                # 1) JPEG ì••ì¶• (ì˜ìƒ ì „ì†¡)
                ok, jpg = cv2.imencode(".jpg", vis_img, [int(cv2.IMWRITE_JPEG_QUALITY), 80])
                if ok:
                    frame_bytes = jpg.tobytes()
                else:
                    frame_bytes = b""

                # 2) ê³µìœ ë©”ëª¨ë¦¬ì—ì„œ Wheel ìƒíƒœ ì½ê¸°
                #    - 11~13 : Wheel ìƒíƒœìš© ëŒ€ì°¨ ë²ˆí˜¸ (ASCII 3ê¸€ì)
                #    - 16    : 1st wheel rotation (0/1/2)
                #    - 17    : 1st wheel position (0/1/2)
                #    - 20    : 2nd wheel rotation (0/1/2)
                #    - 21    : 2nd wheel position (0/1/2)
                ws_car_no = ''.join(chr(status_array[i]) for i in range(11, 14))

                wheel_1st_rot = int(status_array[16])
                wheel_1st_pos = int(status_array[17])
                wheel_2nd_rot = int(status_array[20])
                wheel_2nd_pos = int(status_array[21])

                # car_no ë¬¸ìì—´ ì •ë¦¬ (ì•ˆì „í•˜ê²Œ 3ìë¦¬ë¡œ)
                ws_car_no_str = ws_car_no.strip()
                if not ws_car_no_str:
                    ws_car_no_str = "000"
                elif len(ws_car_no_str) < 3:
                    ws_car_no_str = ws_car_no_str.zfill(3)
                else:
                    ws_car_no_str = ws_car_no_str[:3]

                # 3) ìƒíƒœ JSON íŒ¨í‚· (SHM ê¸°ì¤€ìœ¼ë¡œë§Œ êµ¬ì„±)
                ws_status = {
                    "type": "wheel_status",
                    "pos": "WS",
                    "car_no": ws_car_no_str,
                    "wheel_1st_rotation": wheel_1st_rot,
                    "wheel_1st_position": wheel_1st_pos,
                    "wheel_2nd_rotation": wheel_2nd_rot,
                    "wheel_2nd_position": wheel_2nd_pos,
                }

                status_bytes = json.dumps(ws_status, ensure_ascii=False).encode("utf-8")

                # 4) ë©€í‹°íŒŒíŠ¸ ZMQ ì „ì†¡ (JSON + ì˜ìƒ)
                #    ğŸ‘‰ í´ë¼ì´ì–¸íŠ¸ëŠ” ì²« ë²ˆì§¸ íŒŒíŠ¸ë¥¼ utf-8ë¡œ ë””ì½”ë”©, ë‘ ë²ˆì§¸ë¥¼ JPEGë¡œ ì‚¬ìš©
                ws_sock.send_multipart(
                    [status_bytes, frame_bytes],   # JSON ë¨¼ì €, JPG ë‚˜ì¤‘
                    flags=zmq.NOBLOCK
                )

            except zmq.Again:
                # íê°€ ê½‰ ì°¨ì„œ ì§€ê¸ˆì€ ëª» ë³´ëƒ„ â†’ ì´ í”„ë ˆì„ì€ ê·¸ëƒ¥ ë²„ë¦°ë‹¤
                pass

            except Exception as e:
                print("[ZMQ] WS send error:", e)
